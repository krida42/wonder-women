<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ff6b9d">
    <title>Wonder Women - Rentrez en sÃ©curitÃ© ğŸ’œ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <h1>ğŸ’œ Wonder Women</h1>
                <span class="users-count">
                    <span>ğŸ‘­</span>
                    <span id="usersCount">0</span>
                </span>
            </div>
            <p class="subtitle">Rentrez en sÃ©curitÃ©, ensemble</p>
        </header>

        <main>
            <!-- Map View (Full Screen) -->
            <div class="map-view">
                <div id="nearbyMap"></div>
                <div class="map-info">
                    <span>ğŸ‘­ <span id="nearbyCount">0</span> femme(s) Ã  proximitÃ©</span>
                    <span class="map-hint">Cliquez sur un marqueur pour discuter</span>
                </div>
            </div>

            <!-- Bottom Navigation Bar -->
            <nav class="bottom-navbar">
                <button class="nav-btn" id="tripBtn">
                    <span class="nav-icon">ğŸ </span>
                    <span class="nav-label">Rentrer</span>
                </button>
                <button class="nav-btn nav-btn-sos" id="sosBtn">
                    <span class="nav-icon">ğŸš¨</span>
                    <span class="nav-label">SOS</span>
                </button>
                <button class="nav-btn" id="settingsBtn">
                    <span class="nav-icon">âš™ï¸</span>
                    <span class="nav-label">ParamÃ¨tres</span>
                </button>
            </nav>

            <!-- Trip Bottom Sheet -->
            <div class="bottom-sheet" id="tripSheet">
                <div class="bottom-sheet-content">
                    <div class="bottom-sheet-handle"></div>
                    <h2 class="bottom-sheet-title">ğŸ  Planifier votre trajet</h2>
                    
                    <form id="tripForm">
                        <div class="form-group">
                            <label for="origin">ğŸ“ D'oÃ¹ partez-vous ?</label>
                            <div class="input-with-button">
                                <input type="text" id="origin" placeholder="Position actuelle" required>
                                <button type="button" class="btn-location" id="useLocationBtn" title="Ma position">
                                    ğŸ“
                                </button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="destination">ğŸ  OÃ¹ allez-vous ?</label>
                            <input type="text" id="destination" placeholder="Entrez votre destination" required>
                        </div>

                        <div class="form-group">
                            <label for="departureTime">ğŸ• Quand ?</label>
                            <div class="time-selector">
                                <button type="button" class="time-option active" data-time="now">Maintenant</button>
                                <button type="button" class="time-option" data-time="15">Dans 15 min</button>
                                <button type="button" class="time-option" data-time="30">Dans 30 min</button>
                                <button type="button" class="time-option" data-time="custom">PersonnalisÃ©</button>
                            </div>
                            <input type="datetime-local" id="departureTime" style="display: none;">
                        </div>

                        <button type="submit" class="btn-primary" id="submitBtn">
                            ğŸ’œ Trouver des compagnes
                        </button>
                    </form>
                </div>
            </div>

            <!-- Settings Bottom Sheet -->
            <div class="bottom-sheet" id="settingsSheet">
                <div class="bottom-sheet-content">
                    <div class="bottom-sheet-handle"></div>
                    <h2 class="bottom-sheet-title">âš™ï¸ ParamÃ¨tres</h2>
                    
                    <div class="settings-section">
                        <div class="form-group">
                            <label for="userName">ğŸ’â€â™€ï¸ Votre pseudo</label>
                            <input type="text" id="userName" placeholder="Ex: Sarah">
                            <button type="button" class="btn-secondary" id="saveUserNameBtn">
                                Enregistrer
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- SOS Confirmation Modal -->
            <div class="sos-modal" id="sosModal">
                <div class="sos-modal-content">
                    <div class="sos-modal-icon">ğŸš¨</div>
                    <h2>Envoyer une alerte SOS ?</h2>
                    <p>Les 20 femmes les plus proches seront alertÃ©es de votre situation d'urgence.</p>
                    <div class="sos-modal-buttons">
                        <button class="btn-cancel" id="cancelSosBtn">Annuler</button>
                        <button class="btn-sos-confirm" id="confirmSosBtn">ğŸš¨ Envoyer l'alerte</button>
                    </div>
                </div>
            </div>

            <!-- SOS Alert Received Modal -->
            <div class="sos-alert-modal" id="sosAlertModal">
                <div class="sos-alert-content">
                    <div class="sos-alert-header">
                        <span class="sos-alert-icon">ğŸš¨</span>
                        <h3>ALERTE D'URGENCE</h3>
                    </div>
                    <div class="sos-alert-body">
                        <p class="sos-alert-name"><strong id="sosUserName">Une femme</strong> a besoin d'aide !</p>
                        <p class="sos-alert-distance">ğŸ“ Ã€ <strong id="sosDistance">...</strong> de vous</p>
                    </div>
                    <div class="sos-alert-buttons">
                        <button class="btn-sos-ignore" id="ignoreSosBtn">Ignorer</button>
                        <button class="btn-sos-help" id="helpSosBtn">ğŸ—ºï¸ Voir sa position</button>
                    </div>
                </div>
            </div>

            <!-- Notifications -->
            <div id="notifications" class="notifications"></div>
            
            <!-- Chat Modal -->
            <div id="chatModal" class="chat-modal">
                <div class="chat-container">
                    <div class="chat-header">
                        <div class="chat-user-info">
                            <div class="chat-avatar">ğŸ‘¤</div>
                            <div class="chat-user-name" id="chatUserName">Utilisatrice</div>
                        </div>
                        <button class="chat-close-btn" id="closeChatBtn">âœ•</button>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-welcome">
                            <p>ğŸ’¬ Commencez la conversation</p>
                            <p class="hint">Soyez respectueuse et bienveillante</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input 
                            type="text" 
                            id="chatInput" 
                            class="chat-input" 
                            placeholder="Ã‰crivez votre message..."
                            maxlength="500"
                        />
                        <button class="chat-send-btn" id="sendMessageBtn">
                            <span>ğŸ“¤</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>ğŸ’œ Wonder Women - Rentrez en sÃ©curitÃ©</p>
        </footer>
    </div>

    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="client.js"></script>
</body>
</html>
